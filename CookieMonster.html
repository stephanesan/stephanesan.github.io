<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>The CookieMonster (Hold a Scout to get fed)</title>
<script>
    
  function setCookie(cname,cvalue,exdays)
  {
    var d = new Date();
    d.setTime(d.getTime()+(exdays*24*60*60*1000));
    var expires = "expires="+d.toGMTString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
  }
  
  function getCookie(cname)
  {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) 
    {
      var c = ca[i].trim();
      if (c.indexOf(name)==0) return c.substring(name.length,c.length);
    }
    return "";
  }
  </script>
</head>
  
<body>
  Recieved a Cookie from the scout @ http://jsbin.com/:
  <a id="Cookie" style="color:red"></a>
<script>

  function receiver(e) {
    if (e.origin == "http://jsbin.com") {
      if(e.data == "") {
        alert("First you need to generate the cookie, hit ok to redirect to http://jsbin.com/joxat ...");
        window.location.href="http://jsbin.com/joxat";
      } else {
        setCookie("ScoutCookie", e.data, 1);
        var newC = document.getElementById("Cookie");
      }
      newC.innerText = e.data;
    } else {
      alert("Cookie received from :"+e.origin+"\nNot from my trusted Scout!");
    }
  }
  window.addEventListener('message', receiver, false);
  // Wake up the scout
  ifrm = document.createElement("iframe");   
  ifrm.setAttribute("src", "http://jsbin.com/numav"); 
  ifrm.style.width = "0px"; 
  ifrm.style.height = "0px"; 
  document.body.appendChild(ifrm); 
</script>
</body>
</html>
